{
    "collab_server" : "",
    "contents" : "---\ntitle: \"What is R?\"\nsubtitle: \"\"\nauthor: \"The R Bootcamp<br/>Twitter: <a href='https://twitter.com/therbootcamp'>@therbootcamp</a>\"\ndate: \"June 2017\"\noutput:\n  xaringan::moon_reader:\n    css: [\"default\", \"my-theme.css\"]\n    lib_dir: libs\n    nature:\n      highlightStyle: github\n      highlightLines: true\n      countIncrementalSlides: false\n      ratio: '16:9'\n---\n\n\n\n```{r setup, include=FALSE}\noptions(htmltools.dir.version = FALSE)\n# see: https://github.com/yihui/xaringan\n# install.packages(\"xaringan\")\n# see: \n# https://github.com/yihui/xaringan/wiki\n# https://github.com/gnab/remark/wiki/Markdown\noptions(width=110)\noptions(digits = 4)\n```\n\n# R\n\nFrom [Wikipedia](https://en.wikipedia.org/wiki/Statistical_model) (emphasis added):\n\n> R is an **open source programming language** and software environment for **statistical computing and graphics** that is supported by the R Foundation for Statistical Computing. The R language is **widely used among statisticians and data miners** for developing statistical software and data analysis. Polls, surveys of data miners, and studies of scholarly literature databases show that **R's popularity has increased substantially in recent years**.\n\n> R is a GNU package. The source code for the R software environment is written primarily in **C, Fortran, and R**. R is freely available under the GNU General Public License, and pre-compiled binary versions are provided for various operating systems. While R has a command line interface, there are several **graphical front-ends available**.\n\n---\n\n# Programming language\n\nFrom [Wikipedia](https://en.wikipedia.org/wiki/Statistical_model) (emphasis added):\n\n> A programming language is a **formal language** that specifies a set of instructions that can be used to produce various kinds of output. Programming languages generally consist of **instructions for a computer**. Programming languages can be used to create programs that **implement specific algorithms**.\n\n.pull-left4[\n### Algorithm\n1. Load data\n2. Extract variables\n3. Run analysis\n4. Print result\n]\n\n.pull-right4[\n### Implementation in R\n```{r, results='hide'}\ndata <- read.table('my_data.txt')\nvariables <- data[,c('group','variable')]\nanalysis <- lm(variable ~ group, data = variables)\nsummary(analysis)\n```\n]\n\n---\n\n# R as a programming language\n\nR has been build **statistical computing and graphics**. It is not a full programming language:\n\n.pull-left4[\n\n### Use R for...\n1. Loading and handling data\n2. Run statistical analyses\n3. Run analyses\n4. Prepare reproducible reports\n]\n\n.pull-right4[\n### Don't use R for...\n1. OS programs\n2. Server-side programs\n3. Database handling\n4. (Behvioral experiments)\n]\n\n---\n\n# R is widely used\n\nR has been build **statistical computing and graphics**. It is not a full programming language:\n\n.pull-left4[\n\n### Use R for...\n1. Loading and handling data\n2. Run statistical analyses\n3. Run analyses\n4. Prepare reproducible reports\n]\n\n.pull-right4[\n### Don't use R for...\n1. OS programs\n2. Server-side programs\n3. Database handling\n4. (Behvioral experiments)\n]\n\n---\n\n\nclass: small\n\n# Some Example Data\n\nData from Revelle, Wilt and Rosenthal (2009). `?sat.act`:\n> Items were collected as part of the SAPA project (http://sapa-project.org) to develop online measures of ability (Revelle, Wilt and Rosenthal, 2009). The score means are higher than national norms suggesting both self selection for people taking on line personality and ability tests and a self reporting bias in scores.\n\n```{r, message=FALSE}\nrequire(psych)\ndata(sat.act)\nsat.act$gender <- factor(sat.act$gender, 1:2, labels = c(\"male\", \"female\"))\nsat.act$education <- factor(sat.act$education)\nsummary(sat.act) # alternatively: psych::describe(sat.act)\nsat.act <- na.omit(sat.act)\n```\n\n---\n# Some Example Data\n\n\n```{r, fig.height=4, dev='svg'}\npar(mfrow=c(1,2))\nplot(sat.act$SATV, sat.act$ACT)\nplot(sat.act$SATQ, sat.act$ACT)\n```\n\n---\n# Linear Regression Model\n\n- $\\bf{y}$ = vector of ACT scores of length $n$ (*dependent variable*)\n- $\\bf{x_{\\mbox{SATV}}}$ = vector of SATV scores of length $n$ (*independent variable* or *covariate*)\n\n$$y_i = \\beta_0x_{0,i}+\\beta_{\\mbox{SATV}}x_{\\mbox{SATV},i}+\\epsilon_i, \\ \\ i = 1, ..., n, \\\\\n\\bf{\\epsilon} \\sim \\mathcal{N}(0, \\sigma^2_{\\epsilon}),$$\nwhere $\\bf{x_0}$ is a vector of 1s of length $n$.\n\n- Errors $\\bf{\\epsilon}$ are assumed to come from a normal distribution (i.e., uncorrelated).\n\n- $\\beta_0$ and  $\\beta_{\\mbox{SATV}}$ are scalars (i.e., of length 1) and called *regression coefficients* or *parameters* ( $\\sigma^2_{\\epsilon}$ is also a parameter). $\\beta_0$ is also known as the *intercept*.\n\n******\n\nIn matrix form this model can be expressed as:\n$$\\bf{y} = \\bf{X}\\bf{\\beta}+\\bf{\\epsilon}$$\n\n---\nclass: small\n\n# Linear Model in R\n\n.pull-left2[\n```{r}\nm1 <- lm(ACT ~ SATQ, sat.act)\nsummary(m1)\n```\n\n]\n.pull-right2[\n```{r}\ncoef(m1)\n```\n\n```{r, fig.height=3.7, fig.width=4, dev='svg'}\nplot(sat.act$SATV, sat.act$ACT)\nabline(m1)\n```\n]\n---\nclass: small\n\n# Linear Model in R (Centered)\n\n.pull-left2[\n```{r}\nsat.act$SATQ_c <- sat.act$SATQ - mean(sat.act$SATQ, na.rm = TRUE)\nsat.act$SATV_c <- sat.act$SATV - mean(sat.act$SATV)\nm2 <- lm(ACT ~ SATQ_c, sat.act)\nsummary(m2)\n```\n\n]\n.pull-right2[\n```{r}\ncoef(m2)\n```\n\n```{r, fig.height=3.7, fig.width=4, dev='svg'}\nplot(sat.act$SATV_c, sat.act$ACT)\nabline(m2)\n```\n]\n---\n\nclass: inline-grey\n# Formula Interface for Statistical Models: `~`\n\nAllows symbolic specification of statistical model, e.g. linear models: `lm(ACT ~ SATQ, sat.act)`\n\nEverything to the left of `~` is the dependent variable:\n```r\ny ~ x # univariate model\ncbind(y1, y2, y3) ~ x # multivariate model\n~ x # one sided formula\n```\n\nIndependent variables are to the right of the `~`:\n\n| Formula | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Interpretation  |\n| ------------------------|---|----------------------------------|\n| `~ x` or `~1+x`         || Intercept and main effect of `x` | \n| ` ~ x-1` or `~0 + x`    || Only main effect of `x` and no intercept (questionable) |\n| `~ x+y`                 || Main effects of `x` and `y`|\n| `~ x:y`                 || Interaction between `x` and `y` (and no main effect) |\n| `~ x*y` or `~ x+y+x:y`  || Main effects and interaction between `x` and `y` |\n\n---\nclass: small\n\n# How many Parameters in each Model?\n\n```{r, eval=FALSE}\nlm(ACT ~ SATQ_c + SATV_c, sat.act)   # a\nlm(ACT ~ SATQ_c : SATV_c, sat.act)   # b\nlm(ACT ~ 0 + SATQ_c:SATV_c, sat.act) # c\nlm(ACT ~ SATQ_c*SATV_c, sat.act)     # d\nlm(ACT ~ 0+SATQ_c*SATV_c, sat.act)   # e\n```\n\n--\n.pull-left[\n```{r}\ncoef(lm(ACT ~ SATQ_c + SATV_c, sat.act))   # a\ncoef(lm(ACT ~ SATQ_c : SATV_c, sat.act))   # b\ncoef(lm(ACT ~ 0 + SATQ_c:SATV_c, sat.act)) # c\n```\n\n\n]\n\n.pull-right[\n```{r}\ncoef(lm(ACT ~ SATQ_c*SATV_c, sat.act))     # d\ncoef(lm(ACT ~ 0+SATQ_c*SATV_c, sat.act))   # e\n```\n\n]\n\n```{r, eval=FALSE, include=FALSE}\nsummary(lm(ACT ~ SATQ + SATV, sat.act))   # a\nsummary(lm(ACT ~ SATQ : SATV, sat.act))   # b\nsummary(lm(ACT ~ 0 + SATQ:SATV, sat.act)) # c\nsummary(lm(ACT ~ SATQ*SATV, sat.act))     # d\nsummary(lm(ACT ~ 0+SATQ*SATV, sat.act))   # e\n```\n\n\n---\nclass: center, middle, inverse\n\n# Categorical Covariates\n\n---\nclass: small\n# Categorical Covariates\n\n`R` modeling functions behave differently for numerical and categorical covariates. \n\nIt is important to always know of what type variables are. Use `str()` on a `data.frame` to obtain information regarding the structure, including variable types: \n\n```{r}\nstr(sat.act)\n```\n\n- Numerical covariates are `int` or `num`.\n- Categorical covariates are `Factor` (or `character`).\n\n**Make sure all categorical variables are factors before adding them to a statistical model!**\n\n---\nclass: small\n\n# Models with Categorical Covariates\n\nWe might be interested in testing whether ACT differs between men and women. \n.pull-left2[\n```{r}\nm3 <- lm(ACT ~ gender, sat.act)\nsummary(m3)\n```\n\n]\n--\n\n```{r, include=FALSE}\nop <- options(width = 40)\nrequire(dplyr)\n```\n\n.pull-right2[\n```{r}\nmean(sat.act$ACT)\nsat.act %>% group_by(gender) %>%\n  summarise(m = mean(ACT))\n```\n\n```{r}\nsat.act %>% group_by(gender) %>%\n  summarise(m = mean(ACT)) %>%\n  {.$m[2] - .$m[1]}\n```\n]\n\n```{r, include=FALSE}\noptions(op)\n```\n\n---\nclass: small\n\n# R and Categorical Covariates\n`model.matrix()` transforms categorical covariates into numerical variables that can be used for fitting using a specific contrast function (see `?contr.sum`).\n\n.pull-left[\n```{r}\nmodel.matrix(ACT ~ gender, sat.act[1:5,])\n```\n]\n\n---\nclass: small\n# R and Categorical Covariates\n\n`model.matrix()` transforms categorical covariates into numerical variables that can be used for fitting using a specific contrast function (see `?contr.sum`).\n\n.pull-left[\n```{r}\nmodel.matrix(ACT ~ gender, sat.act[1:5,])\n```\n\n```{r}\nafex::set_sum_contrasts()\n```\n\n]\n\n.pull-right[\n```{r}\nmodel.matrix(ACT ~ gender, sat.act[1:5,])\n```\n]\n\n---\nclass: small\n\n# Models with Categorical Covariates II \n\nSame model as before, but with sum/effects contrasts.\n\n.pull-left2[\n```{r}\nm4 <- lm(ACT ~ gender, sat.act)\nsummary(m4)\n```\n\n]\n\n```{r, include=FALSE}\nop <- options(width = 40)\n```\n\n.pull-right2[\n```{r}\nmean(sat.act$ACT)\nsat.act %>% group_by(gender) %>%\n  summarise(m = mean(ACT))\nsat.act %>% group_by(gender) %>%\n  summarise(m = mean(ACT)) %>% \n  summarise(mean(m))\n\n```\n\n]\n\n```{r, include=FALSE}\noptions(op)\n```\n\n---\nclass: small\n# Models with Categorical Covariates and Interactions\n\n```{r}\nafex::set_default_contrasts() # or set_treatment_contrasts()\n```\n\n\n```{r, include=FALSE}\nop <- options(width = 70)\n```\n\n.pull-left2[\n```{r}\nm5 <- lm(ACT ~ gender*education, sat.act)\ncoef(m5)\n```\n\n]\n\n.pull-right2[\n```{r}\nsat.act %>% \n  group_by(gender,education) %>%\n  summarise(mean(ACT))\n```\n]\n\n```{r, include=FALSE}\noptions(op)\n```\n\n---\nclass: small\n# Models with Categorical Covariates and Interactions II\n\n```{r}\nafex::set_sum_contrasts() # or set_effects_contrasts() or set_deviation_contrasts()\n```\n\n\n```{r, include=FALSE}\nop <- options(width = 70)\n```\n\n.pull-left2[\n```{r}\nm6 <- lm(ACT ~ gender*education, sat.act)\ncoef(m6)\n```\n\n]\n\n.pull-right2[\n```{r}\nsat.act %>% \n  group_by(gender,education) %>%\n  summarise(m = mean(ACT)) %>% \n  ungroup() %>% \n  summarise(mean(m))\n```\n]\n\n```{r, include=FALSE}\noptions(op)\n```\n\n---\n# Categorical Covariates and Model Matrices\n\n.pull-left3[\n```{r, eval=FALSE}\nlm(ACT ~ SATQ + SATV, sat.act)   # a: 3\nlm(ACT ~ SATQ : SATV, sat.act)   # b: 2\nlm(ACT ~ 0 + SATQ:SATV, sat.act) # c: 1\nlm(ACT ~ SATQ*SATV, sat.act)     # d: 4\nlm(ACT ~ 0+SATQ*SATV, sat.act)   # e: 3\n\nlm(ACT ~ SATQ, sat.act)          # f: 2\nlm(ACT ~ 0 + SATQ, sat.act)      # g: 1\n```\n\n]\n\n--\n.pull-right3[\n```{r, eval=FALSE}\nlm(ACT ~ gender, sat.act)                  # a\nlm(ACT ~ 0+gender, sat.act)                # b\nlm(ACT ~ gender+education, sat.act)        # c\nlm(ACT ~ 0+gender+education, sat.act)      # d\nlm(ACT ~ gender:education, sat.act)        # e\nlm(ACT ~ 0+gender:education, sat.act)      # f\nlm(ACT ~ gender*education, sat.act)        # g\nlm(ACT ~ 0+gender*education, sat.act)      # h\nlm(ACT ~ gender+gender:education, sat.act) # i\n```\n\n```{r}\nlevels(sat.act$gender)\nlevels(sat.act$education)\n```\n\n\n]\n\n\n---\nclass: small\n\n# Beware of Formulas with Categorical Variables\n\n\n```{r}\ncoef(lm(ACT ~ gender, sat.act))                  # a: 2\ncoef(lm(ACT ~ 0+gender, sat.act))                # b: 2\ncoef(lm(ACT ~ gender+education, sat.act))        # c: 7\ncoef(lm(ACT ~ 0+gender+education, sat.act))      # d: 7\n```\n\n---\nclass: small\n\n\n```{r}\ncoef(lm(ACT ~ gender:education, sat.act))        # e: 13\ncoef(lm(ACT ~ 0+gender:education, sat.act))      # f: 12\n```\n\n```{r, eval = FALSE}\ncoef(lm(ACT ~ gender*education, sat.act))        # g: 12\ncoef(lm(ACT ~ 0+gender*education, sat.act))      # h: 12\ncoef(lm(ACT ~ gender+gender:education, sat.act)) # i: 12\n```\n\n\n\n---\nclass: inline-grey\n# Interim Summary\n\n- The `R` `formula` interface allows symbolic specification of statistical models.\n  - `+` = main effects\n  - `:` = interaction\n  - `*` = main effects plus interaction\n  - `0+`/`-1` = no intercept\n\n- Categorical variables are transformed into numerical variables using contrast functions (via `model.matrix()`; see Cohen et al., 2002)\n  - If models include interactions, orthogonal contrasts (e.g., `contr.sum`) in which the intercept corresponds to the (unweighted) grand mean should be used: `afex::set_sum_contrasts()`\n  - Dummy/treatment contrasts (`R` default) lead to simple effects for lower order effects.\n  - **Coding only affects interpretation of parameters/tests not overall model fit.**\n\n- For models with only numerical covariates, suppressing intercept works as expected.\n- For models with categorical covariates, suppressing intercept or other lower-order effects often leads to very surprising results (and should generally be avoided).\n\n---\nclass: center, middle, inverse\n\n# Tests of Terms/Effects\n\n---\nclass: small\n\n```{r, include=FALSE}\nop <- options(width = 70)\n```\n\n.pull-left2[\n```{r, message=FALSE}\nafex::set_sum_contrasts()\nm6 <- lm(ACT ~ gender*education, sat.act)\nsummary(m6)\n```\n\n]\n\n.pull-right2[\n```{r}\nsat.act %>% \n  group_by(gender, education) %>%\n  summarise(m = mean(ACT)) %>% \n  ungroup() %>% \n  summarise(mean(m))\n```\n]\n\n```{r, include=FALSE}\noptions(op)\n```\n\n---\n\n# `car::Anova()` is the Solution\n\n```{r, message=FALSE}\nrequire(car) # Companion to Applied Regression (Fox & Weisberg, 2011)\nAnova(m6, type = 3)\n```\n--\n\n- Type II and III tests equivalent for balanced designs (i.e., equal group sizes) and highest-order effect.\n- Type III tests require orthogonal contrasts (e.g.,`contr.sum`); recommended:\n  - For experimental designs in which imbalance is completely random and not structural,\n  - Complete cross-over interactions (i.e., main effects in presence of interaction) possible.\n- Type II are more appropriate if imbalance is structural (i.e., observational data; maybe here).\n\n\n\n---\n### References Statistical Modeling:\n- John Fox and Sanford Weisberg (2011). *An R Companion to Applied Regression, Second Edition.* Thousand Oaks CA: Sage. URL: http://socserv.socsci.mcmaster.ca/jfox/Books/Companion\n- Russell V. Lenth (2016). Least-Squares Means: The R Package lsmeans. *Journal of Statistical\n  Software*, 69(1), 1-33. https://doi.org/10.18637/jss.v069.i01\n- Cohen, J., Cohen, P., West, S. G., & Aiken, L. S. (2002). *Applied Multiple Regression/Correlation Analysis for the Behavioral Sciences.* New York: Routledge Academic.\n\n### References Example Data:\n- Revelle, William, Wilt, Joshua, and Rosenthal, Allen (2009) Personality and Cognition: The Personality-Cognition Link. In Gruszka, Alexandra and Matthews, Gerald and Szymura, Blazej (Eds.) _Handbook of Individual Differences in Cognition: Attention, Memory and Executive Control_, Springer.\n- Skovgaard-Olsen, N., Singmann, H., & Klauer, K. C. (2016). The relevance effect and conditionals. *Cognition*, 150, 26-36. https://doi.org/10.1016/j.cognition.2015.12.017\n",
    "created" : 1504354238416.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2687452230",
    "id" : "B5B582FD",
    "lastKnownWriteTime" : 1504355229,
    "last_content_update" : 1504355302883,
    "path" : "~/Dropbox (2.0)/Work/Software/BaselRBootcamp2017/slides/what_is_R.Rmd",
    "project_path" : "slides/what_is_R.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}